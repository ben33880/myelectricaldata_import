name: "[DEBUG] Inspect Docker Config"

on:
  workflow_dispatch:

env:
  DOCKERHUB_USERNAME: "pbranly"   # ‚ö†Ô∏è ton login DockerHub en clair pour debug

jobs:
  test-dockerhub:
    runs-on: ubuntu-latest
    steps:
      - name: V√©rifier les variables
        run: |
          echo "DOCKERHUB_USERNAME = $DOCKERHUB_USERNAME"
          if [ -z "${{ secrets.DOCKERHUB_TOKEN }}" ]; then
            echo "‚ùå DOCKERHUB_TOKEN est vide"
            exit 1
          else
            echo "‚úÖ DOCKERHUB_TOKEN est d√©fini (non affich√© pour s√©curit√©)"
          fi

      - name: Login DockerHub
        run: |
          echo "${{ secrets.DOCKERHUB_TOKEN }}" | docker login -u "$DOCKERHUB_USERNAME" --password-stdin

      - name: Inspecter ~/.docker/config.json
        run: |
          echo "üëâ Contenu brut de ~/.docker/config.json"
          cat ~/.docker/config.json

          echo "üëâ Auth d√©cod√©e :"
          cat ~/.docker/config.json | jq -r '.auths["https://index.docker.io/v1/"].auth' | base64 -d
